diff --git a/client/hooks/useGameState.ts b/client/hooks/useGameState.ts
index xxxxxxx..xxxxxxx 100644
--- a/client/hooks/useGameState.ts
+++ b/client/hooks/useGameState.ts
@@ -10,9 +10,11 @@ import { getWebrtcManager, type WebrtcEvent } from '../utils/webrtcManager'
 import {
   applyStateDelta,
   createDeltaFromStates,
   isDeltaEmpty
 } from '../utils/stateDelta'
+import { HostManager } from '../webrtc/host/HostManager'
+import { GuestManager } from '../webrtc/guest/GuestManager'
+import type { WebrtcMessage } from '../webrtc/types'
 import {
   saveHostData,
   loadHostData,
@@ -437,6 +439,8 @@ export const useGameState = (props: UseGameStateProps = {}) => {
   const playerTokenRef = useRef<string | undefined>(undefined)
   const receivedServerStateRef = useRef<boolean>(false) // Track if we've received server state after connection

-  // WebRTC manager ref
+  // WebRTC manager and host/guest manager refs
   const webrtcManagerRef = useRef<ReturnType<typeof getWebrtcManager> | null>(null)
+  const hostManagerRef = useRef<HostManager | null>(null)
+  const guestManagerRef = useRef<GuestManager | null>(null)

   // Ref for setGameStateWithDelta (used in callbacks)
   const setGameStateWithDeltaRef = useRef<(updater: React.SetStateAction<GameState>, sourcePlayerId?: number) => void>(() => {})

@@ -445,6 +449,15 @@ export const useGameState = (props: UseGameStateProps = {}) => {
   useEffect(() => {
     setGameStateWithDeltaRef.current = setGameStateWithDelta
   }, [setGameStateWithDelta])
+
+  /**
+   * Get current WebRTC manager (host or guest) based on mode
+   */
+  const getCurrentManager = useCallback(() => {
+    return webrtcIsHostRef.current ? hostManagerRef.current : guestManagerRef.current
+  }, [])

   // Sync webrtcIsHost ref with state (for use in callbacks that need current value)
   useEffect(() => {
@@ -452,10 +465,14 @@ export const useGameState = (props: UseGameStateProps = {}) => {
   // Initialize WebRTC manager
   useEffect(() => {
     // Check if WebRTC is enabled in settings
     const webrtcSetting = localStorage.getItem('webrtc_enabled') === 'true'
+
     if (webrtcSetting) {
       webrtcManagerRef.current = getWebrtcManager()
       logger.info('WebRTC manager initialized')

-      // Setup WebRTC event handlers
-      const cleanup = webrtcManagerRef.current.on((event: WebrtcEvent) => {
-        handleWebrtcEvent(event)
-      })
-
+      // Setup WebRTC base manager events (low-level connection events only)
+      const cleanup = webrtcManagerRef.current.on((event: WebrtcEvent) => {
+        // Only handle low-level events here; high-level events go to managers
+        if (event.type === 'peer_open' || event.type === 'peer_closed' || event.type === 'error') {
+          handleWebrtcEvent(event)
+        }
+      })
+
       return () => {
         cleanup()
+        // Cleanup managers
+        hostManagerRef.current?.cleanup()
+        guestManagerRef.current?.cleanup()
         // Don't destroy manager on unmount, just cleanup listeners
       }
     }
@@ -509,8 +536,28 @@ export const useGameState = (props: UseGameStateProps = {}) => {
           if (!hostData || !stateData) {
             logger.warn('[Auto-restore] Missing host data or state data')
             clearWebrtcData()
+            isRestoringSessionRef.current = false
             return
           }

           logger.info(`[Auto-restore] Restoring host session: old peerId=${hostData.peerId}`)

+          // Initialize HostManager before initializing as host
+          if (!hostManagerRef.current) {
+            hostManagerRef.current = new HostManager(webrtcManagerRef.current, {
+              autoSaveState: true,
+              autoBroadcastState: true,
+              stateSaveInterval: 5000
+            })
+
+            // Setup host manager event handlers
+            hostManagerRef.current.on('guest_joined', (data) => {
+              logger.info(`[HostManager] Guest joined: ${data.peerId}`)
+            })
+            hostManagerRef.current.on('action', (data) => {
+              logger.info(`[HostManager] Action from player ${data.playerId}: ${data.actionType}`)
+              handleHostAction(data.playerId, data.actionType, data.data)
+            })
+            hostManagerRef.current.on('state_changed', (newState) => {
+              // Host state changed - will be broadcast by manager
+              logger.debug('[HostManager] State changed')
+            })
+            hostManagerRef.current.on('no_guests_remaining', () => {
+              logger.info('[HostManager] No guests remaining')
+            })
+          }
+
           // IMPORTANT: Do NOT reuse old peerId - PeerJS cannot reuse peerIds after page reload
           // Always create a NEW peerId and broadcast it so guests can discover it
-          const peerId = await webrtcManagerRef.current.initializeAsHost()
+          const peerId = await hostManagerRef.current.initialize(hostData.peerId)
+          if (!peerId) {
+            logger.error('[Auto-restore] Failed to initialize host')
+            clearWebrtcData()
+            isRestoringSessionRef.current = false
+            return
+          }
+
+          // Set game state in host manager
+          if (stateData.gameState) {
+            hostManagerRef.current.setGameState(stateData.gameState)
+          }
+
           webrtcIsHostRef.current = true
           setWebrtcIsHost(true)
           setWebrtcHostId(peerId)
@@ -583,9 +630,23 @@ export const useGameState = (props: UseGameStateProps = {}) => {
             return
           }

           logger.info(`[Auto-restore] Restoring guest session: old hostPeerId=${guestData.hostPeerId}, playerId=${guestData.playerId}`)

+          // Initialize GuestManager before connecting
+          if (!guestManagerRef.current) {
+            guestManagerRef.current = new GuestManager(webrtcManagerRef.current, {
+              reconnectDelay: 2000,
+              maxReconnectAttempts: 10,
+              connectionTimeout: 30000
+            })
+
+            // Setup guest manager event handlers
+            guestManagerRef.current.on('connected_to_host', () => {
+              logger.info('[GuestManager] Connected to host')
+              setConnectionStatus('Connected')
+              setIsReconnecting(false)
+              setReconnectProgress(null)
+              recentlyRestoredFromStorageRef.current = false
+            })
+            guestManagerRef.current.on('host_disconnected', () => {
+              logger.info('[GuestManager] Host disconnected')
+              setConnectionStatus('Disconnected')
+            })
+            guestManagerRef.current.on('state_changed', (newState) => {
+              setGameState(newState)
+            })
+            guestManagerRef.current.on('failed', () => {
+              logger.error('[GuestManager] Connection failed')
+              clearWebrtcData()
+            })
+          }
+
           webrtcIsHostRef.current = false
           setWebrtcIsHost(false)
           setConnectionStatus('Connecting')
@@ -599,17 +650,13 @@ export const useGameState = (props: UseGameStateProps = {}) => {
           // If we have a player ID, reconnect as existing player
           if (guestData.playerId !== null) {
             logger.info(`[Auto-restore] Reconnecting as existing player ${guestData.playerId} to host ${hostPeerId}`)
-            try {
-              await webrtcManagerRef.current.initializeAsReconnectingGuest(hostPeerId, guestData.playerId)
-              // Connection succeeded - we're now connected
-              setConnectionStatus('Connected')
-              logger.info('[Auto-restore] Successfully reconnected to host')
-            } catch (err) {
-              logger.error('[Auto-restore] Failed to reconnect to host:', err)
-              setConnectionStatus('Disconnected')
-              // Clear stale guest data so next refresh starts fresh instead of trying to reconnect again
-              clearWebrtcData()
-              logger.info('[Auto-restore] Cleared stale guest data due to failed reconnection')
-              isRestoringSessionRef.current = false
-              return
+            const connected = await guestManagerRef.current.connectToHost(hostPeerId)
+            if (connected) {
+              setConnectionStatus('Connected')
+              logger.info('[Auto-restore] Successfully reconnected to host')
+            } else {
+              logger.error('[Auto-restore] Failed to reconnect to host')
+              setConnectionStatus('Disconnected')
+              clearWebrtcData()
+              isRestoringSessionRef.current = false
+              return
             }
           } else {
             // New player - fall back to standard join
             logger.info(`[Auto-restore] Connecting as new player`)
-            await webrtcManagerRef.current.initializeAsGuest(hostPeerId)
-            setConnectionStatus('Connected')
+            const connected = await guestManagerRef.current.connectToHost(hostPeerId)
+            if (connected) {
+              setConnectionStatus('Connected')
+            }
           }

           // Restore game state and localPlayerId atomically to prevent race condition
@@ -716,6 +763,31 @@ export const useGameState = (props: UseGameStateProps = {}) => {
   /**
    * Handle WebRTC events from P2P manager
    */
-  const handleWebrtcEvent = useCallback((event: WebrtcEvent) => {
+  const handleWebrtcEvent = useCallback((event: WebrtcEvent) => {
     switch (event.type) {
       case 'peer_open':
         // Host: Peer is ready, peerId is available
@@ -748,7 +820,22 @@ export const useGameState = (props: UseGameStateProps = {}) => {
       case 'error':
         logger.error('WebRTC error:', event.data)
         break
     }
-  }, [gameState, localPlayerId, webrtcHostId, webrtcIsHost])
+  }, [])
+
+  /**
+   * Handle action from guest (host only)
+   */
+  const handleHostAction = useCallback((playerId: number, actionType: string, data: any) => {
+    // This is called by HostManager when a guest sends an action
+    // The actual game logic is handled elsewhere via state updates
+    logger.info(`[handleHostAction] Player ${playerId}: ${actionType}`)
+  }, [])
+
+  /**
+   * Handle message from host (guest only)
+   */
+  const handleGuestMessage = useCallback((message: WebrtcMessage) => {
+    // Forward to existing WebRTC message handler
+    handleWebrtcMessage(message)
+  }, [])

   /**
    * Handle WebRTC guest join request (host only)
@@ -756,8 +853,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     logger.info(`[handleWebrtcGuestJoin] Called for guest ${guestPeerId}, isHost: ${webrtcIsHostRef.current}`)
     if (!webrtcIsHostRef.current || !webrtcManagerRef.current) {
       logger.warn('[handleWebrtcGuestJoin] Not a host or manager not initialized')
-      return
+      return
     }

     setGameState(prevState => {
@@ -850,7 +876,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
         // Send deck selection to host (only if we created a new deck, not when reconnecting with full data)
         if (createdNewDeck) {
           if (localPlayerRef && webrtcManagerRef.current) {
-            webrtcManagerRef.current.sendAction('CHANGE_PLAYER_DECK', {
+            guestManagerRef.current?.sendAction('CHANGE_PLAYER_DECK', {
               playerId: message.playerId,
               deckType: localPlayerRef.selectedDeck
             })
@@ -1301,7 +1327,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {

   /**
    * Handle incoming WebRTC message
    */
-  const handleWebrtcMessage = useCallback((message: any) => {
+  const handleWebrtcMessage = useCallback((message: WebrtcMessage) => {
     if (!message || !message.type) {return}

     // Log ALL incoming WebRTC messages for debugging
@@ -1395,7 +1421,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     if (!webrtcIsHostRef.current || !webrtcManagerRef.current) {return}

     // Build optimized state for WebRTC broadcasting
-    const optimizedState = optimizeStateForWebRTC(newState)
+    const optimizedState = optimizeStateForWebRTC(newState)

     // Broadcast to all guests
     webrtcManagerRef.current.broadcastGameState(optimizedState)
@@ -1432,7 +1458,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
           playerId: localPlayerIdRef.current,
           deckType
         })
-        webrtcManagerRef.current.sendToGuest(message.senderId, {
+        getCurrentManager()?.sendToGuest(message.senderId, {
           type: 'CHANGE_PLAYER_DECK',
           playerId: localPlayerIdRef.current,
           deckType,
@@ -1463,7 +1489,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
         const safeDelta = { ...delta, playerDeltas: {} }
         delete safeDelta.playerDeltas
         delete safeDelta.sourcePlayerId
-        webrtcManagerRef.current.broadcastStateDelta(safeDelta, message.senderId)
+        getCurrentManager()?.broadcastStateDelta(safeDelta, message.senderId)
         logger.info(`[CHANGE_PLAYER_DECK] Broadcast safe delta without playerDeltas`)
       }
     }
@@ -1489,7 +1515,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
       if (!isDeltaEmpty(delta)) {
         // Broadcast visual effect to all other guests (excluding sender)
         const safeDelta = { ...delta, playerDeltas: {} }
-        webrtcManagerRef.current.broadcastStateDelta(safeDelta)
+        getCurrentManager()?.broadcastStateDelta(safeDelta)
         logger.info(`[TRIGGER_HIGHLIGHT] Broadcast safe delta to all guests`)
       }
     }
@@ -1511,7 +1537,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     }

     // Broadcast to all guests (host only)
-    webrtcManagerRef.current.broadcastToGuests({
+    getCurrentManager()?.broadcastToGuests({
       type: 'TRIGGER_NO_TARGET',
       senderId: webrtcManagerRef.current.getPeerId(),
       data: { coords, timestamp },
@@ -1540,7 +1566,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     }

     // Broadcast to all guests (host only)
-    webrtcManagerRef.current.broadcastToGuests({
+    getCurrentManager()?.broadcastToGuests({
       type: 'SYNC_HIGHLIGHTS',
       senderId: webrtcManagerRef.current.getPeerId(),
       data: { highlights },
@@ -1615,7 +1641,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     if (webrtcEnabled && webrtcManagerRef.current && webrtcIsHostRef.current) {
       const delta = createDeltaFromStates(prevState, newState, localPlayerIdRef.current || 0)
       if (!isDeltaEmpty(delta)) {
-        webrtcManagerRef.current.broadcastStateDelta(delta)
+        getCurrentManager()?.broadcastStateDelta(delta)
         logger.info(`[drawCard] Broadcast delta: board=${delta.boardCells?.length || 0}, players=${Object.keys(delta.playerDeltas || {}).length}`)
       }
     }
@@ -1647,7 +1673,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     if (webrtcEnabled && webrtcManagerRef.current && webrtcIsHostRef.current) {
       const delta = createDeltaFromStates(prevState, updatedState, localPlayerIdRef.current || 0)
       if (!isDeltaEmpty(delta)) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'SHUFFLE_PLAYER_DECK',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { delta },
@@ -1730,7 +1756,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     if (webrtcEnabled && webrtcManagerRef.current && webrtcIsHostRef.current) {
       const delta = createDeltaFromStates(prevState, updatedState, localPlayerIdRef.current || 0)
       if (!isDeltaEmpty(delta)) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'RETURN_CARD_TO_HAND',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { delta },
@@ -1751,7 +1777,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     if (webrtcEnabled && webrtcManagerRef.current && webrtcIsHostRef.current) {
       const delta = createDeltaFromStates(prevState, updatedState, localPlayerIdRef.current || 0)
       if (!isDeltaEmpty(delta)) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'ANNOUNCE_CARD',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { delta },
@@ -1781,7 +1807,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     if (webrtcEnabled && webrtcManagerRef.current && webrtcIsHostRef.current) {
       const delta = createDeltaFromStates(prevState, updatedState, localPlayerIdRef.current || 0)
       if (!isDeltaEmpty(delta)) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'END_TURN',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { delta },
@@ -1811,7 +1837,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     if (webrtcEnabled && webrtcManagerRef.current && webrtcIsHostRef.current) {
       const delta = createDeltaFromStates(prevState, updatedState, localPlayerIdRef.current || 0)
       if (!isDeltaEmpty(delta)) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'PLAY_COUNTER',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { delta },
@@ -1841,7 +1867,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     if (webrtcEnabled && webrtcManagerRef.current && webrtcIsHostRef.current) {
       const delta = createDeltaFromStates(prevState, updatedState, localPlayerIdRef.current || 0)
       if (!isDeltaEmpty(delta)) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'PLAY_TOKEN',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { delta },
@@ -1891,7 +1917,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     if (webrtcEnabled && webrtcManagerRef.current && webrtcIsHostRef.current) {
       const delta = createDeltaFromStates(prevState, updatedState, localPlayerIdRef.current || 0)
       if (!isDeltaEmpty(delta)) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'DESTROY_CARD',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { delta },
@@ -2130,7 +2156,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
       case 'TRIGGER_FLOATING_TEXT':
         // Broadcast to all guests
         if (webrtcManagerRef.current && webrtcIsHostRef.current) {
-          webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
             type: 'TRIGGER_FLOATING_TEXT',
             senderId: webrtcManagerRef.current.getPeerId(),
             data: { batch },
@@ -2153,7 +2179,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
         if (webrtcManagerRef.current && webrtcIsHostRef.current) {
           const delta = createDeltaFromStates(prevState, updatedState, localPlayerIdRef.current || 0)
           if (!isDeltaEmpty(delta)) {
-            webrtcManagerRef.current.broadcastStateDelta(delta, message.senderId)
+            getCurrentManager()?.broadcastStateDelta(delta, message.senderId)
           }
         }
       } else if (webrtcManagerRef.current && !webrtcIsHostRef.current) {
         // Guest sends action to host
-        webrtcManagerRef.current.sendAction('CHANGE_PLAYER_DECK', {
+        guestManagerRef.current?.sendAction('CHANGE_PLAYER_DECK', {
           playerId: localPlayerIdRef.current,
           deckType
         })
@@ -2175,7 +2201,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     if (webrtcEnabled && webrtcManagerRef.current && webrtcIsHostRef.current) {
       const delta = createDeltaFromStates(prevState, updatedState, localPlayerIdRef.current || 0)
       if (!isDeltaEmpty(delta)) {
-        webrtcManagerRef.current.broadcastStateDelta(delta)
+        getCurrentManager()?.broadcastStateDelta(delta)
       }
     } else if (webrtcManagerRef.current && !webrtcIsHostRef.current) {
       // Guest sends action to host
-      webrtcManagerRef.current.sendAction('SHUFFLE_PLAYER_DECK', {})
+      guestManagerRef.current?.sendAction('SHUFFLE_PLAYER_DECK', {})
     }

     return updatedState
@@ -2217,7 +2243,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     if (webrtcEnabled && webrtcManagerRef.current && webrtcIsHostRef.current) {
       const delta = createDeltaFromStates(prevState, updatedState, localPlayerIdRef.current || 0)
       if (!isDeltaEmpty(delta)) {
-        webrtcManagerRef.current.broadcastStateDelta(delta)
+        getCurrentManager()?.broadcastStateDelta(delta)
       }
     } else if (webrtcManagerRef.current && !webrtcIsHostRef.current) {
       // Guest sends action to host
-      webrtcManagerRef.current.sendAction(actionType, actionData)
+      guestManagerRef.current?.sendAction(actionType, actionData)
     }

     return updatedState
@@ -2267,7 +2293,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
    * Initialize WebRTC as host
    */
   const initializeWebrtcHost = useCallback(async (): Promise<string | null> => {
-    if (!webrtcManagerRef.current) {
+    if (!webrtcManagerRef.current || !hostManagerRef.current) {
       logger.error('WebRTC manager not initialized')
       return null
     }

     try {
       setWebrtcIsHost(true)
       setConnectionStatus('Connecting')
-      const peerId = await webrtcManagerRef.current.initializeAsHost()
+      const peerId = await hostManagerRef.current.initialize()
+      if (!peerId) {
+        logger.error('Failed to initialize WebRTC host')
+        setConnectionStatus('Disconnected')
+        return null
+      }
       setWebrtcHostId(peerId)
       setConnectionStatus('Connected')

@@ -2317,12 +2343,12 @@ export const useGameState = (props: UseGameStateProps = {}) => {
    * Connect as guest to host via WebRTC
    */
   const connectAsGuest = useCallback(async (hostId: string): Promise<boolean> => {
-    if (!webrtcManagerRef.current) {
+    if (!webrtcManagerRef.current || !guestManagerRef.current) {
       logger.error('WebRTC manager not initialized')
       return false
     }

     try {
       setWebrtcIsHost(false)
       setConnectionStatus('Connecting')
-      await webrtcManagerRef.current.initializeAsGuest(hostId)
+      if (!guestManagerRef.current) {
+        guestManagerRef.current = new GuestManager(webrtcManagerRef.current, {
+          reconnectDelay: 2000,
+          maxReconnectAttempts: 10,
+          connectionTimeout: 30000
+        })
+      }
+      return await guestManagerRef.current.connectToHost(hostId)
       return true
     } catch (err) {
       logger.error('Failed to connect as guest:', err)
@@ -2334,7 +2360,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
    * Send action to host via WebRTC (guest only)
    */
   const sendWebrtcAction = useCallback((actionType: string, actionData: any) => {
-    if (!webrtcManagerRef.current || webrtcIsHostRef.current) {return false}
-    return webrtcManagerRef.current.sendAction(actionType, actionData)
+    if (!webrtcManagerRef.current || webrtcIsHostRef.current || !guestManagerRef.current) {return false}
+    return guestManagerRef.current.sendAction(actionType, actionData)
   }, [])

   const updateState = useCallback((newStateOrFn: GameState | ((prevState: GameState) => GameState)) => {
@@ -2349,7 +2375,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
       // Use WebRTC for P2P communication if enabled
       if (webrtcEnabled && webrtcManagerRef.current) {
         const delta = createDeltaFromStates(prevState, newState, localPlayerIdRef.current || 0)

         if (webrtcIsHostRef.current) {
           // Host broadcasts delta to all guests (efficient)
           if (!isDeltaEmpty(delta)) {
-            webrtcManagerRef.current.broadcastStateDelta(delta)
+            getCurrentManager()?.broadcastStateDelta(delta)
             logger.info(`[updateState] Host broadcast delta: phase=${!!delta.phaseDelta}, board=${delta.boardCells?.length || 0}`)
           }
           // Save game state for auto-restore after F5 (host only)
@@ -2366,7 +2392,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
         } else {
           // Guest sends delta to host (which will then broadcast to all)
           if (!isDeltaEmpty(delta)) {
-            const success = webrtcManagerRef.current.sendStateDelta(delta)
+            const success = guestManagerRef.current?.sendStateDelta(delta) ?? false
             logger.info(`[updateState] Guest sent delta to host: success=${success}, boardCells=${delta.boardCells?.length || 0}`)
           } else {
             logger.debug('[updateState] Delta empty, skipping send')
@@ -3042,7 +3068,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     if (webrtcEnabled && webrtcManagerRef.current && webrtcIsHostRef.current) {
       const delta = createDeltaFromStates(prevState, updatedState, localPlayerIdRef.current || 0)
       if (!isDeltaEmpty(delta)) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'ADD_COMMAND',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { delta },
@@ -3068,7 +3094,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     if (webrtcEnabled && webrtcManagerRef.current && webrtcIsHostRef.current) {
       const delta = createDeltaFromStates(prevState, updatedState, localPlayerIdRef.current || 0)
       if (!isDeltaEmpty(delta)) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'EXECUTE_COMMAND',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { delta },
@@ -3155,7 +3181,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'TRIGGER_DECK_SELECTION',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { deckSelections },
@@ -3163,7 +3189,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
         })
       } else {
         // Guest sends action to host
-        webrtcManagerRef.current.sendMessageToHost({
+        guestManagerRef.current?.sendAction('TRIGGER_DECK_SELECTION', {
           deckSelections
         })
       }
@@ -3181,7 +3207,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'TRIGGER_HAND_CARD_SELECTION',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { handCardSelections },
@@ -3189,7 +3215,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
         })
       } else {
         // Guest sends action to host
-        webrtcManagerRef.current.sendMessageToHost({
+        guestManagerRef.current?.sendAction('TRIGGER_HAND_CARD_SELECTION', {
           handCardSelections
         })
       }
@@ -3213,7 +3239,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'SET_TARGETING_MODE',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { targetingMode },
@@ -3221,7 +3247,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
         })
       } else {
         // Guest sends action to host
-        webrtcManagerRef.current.sendMessageToHost({
+        guestManagerRef.current?.sendAction('SET_TARGETING_MODE', {
           targetingMode
         })
       }
@@ -3245,7 +3271,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'CLEAR_TARGETING_MODE',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { timestamp },
@@ -3253,7 +3279,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
         })
       } else {
         // Guest sends action to host
-        webrtcManagerRef.current.sendMessageToHost({
+        guestManagerRef.current?.sendAction('CLEAR_TARGETING_MODE', {
           timestamp
         })
       }
@@ -3908,7 +3934,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     if (webrtcEnabled && webrtcManagerRef.current && webrtcIsHostRef.current) {
       const delta = createDeltaFromStates(prevState, updatedState, localPlayerIdRef.current || 0)
       if (!isDeltaEmpty(delta)) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'START_READY_CHECK',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { delta },
@@ -3972,7 +3998,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests(webrtcMessage)
+        getCurrentManager()?.broadcastToGuests(webrtcMessage)
       } else {
-        webrtcManagerRef.current.sendMessageToHost(webrtcMessage)
+        guestManagerRef.current?.sendAction('PLAYER_READY', webrtcMessage.data)
       }
     }
@@ -4006,7 +4032,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests(webrtcMessage)
+        getCurrentManager()?.broadcastToGuests(webrtcMessage)
       } else {
-        webrtcManagerRef.current.sendMessageToHost(webrtcMessage)
+        guestManagerRef.current?.sendAction('CANCEL_READY_CHECK', webrtcMessage.data)
       }
     }
@@ -4035,7 +4061,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests(webrtcMessage)
+        getCurrentManager()?.broadcastToGuests(webrtcMessage)
       } else {
-        webrtcManagerRef.current.sendMessageToHost(webrtcMessage)
+        guestManagerRef.current?.sendAction('TOGGLE_AUTO_ABILITIES', webrtcMessage.data)
       }
     }
@@ -4059,7 +4085,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests(webrtcMessage)
+        getCurrentManager()?.broadcastToGuests(webrtcMessage)
       } else {
-        webrtcManagerRef.current.sendMessageToHost(webrtcMessage)
+        guestManagerRef.current?.sendAction('NEXT_PHASE', webrtcMessage.data)
       }
     }
@@ -4095,7 +4121,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests(webrtcMessage)
+        getCurrentManager()?.broadcastToGuests(webrtcMessage)
       } else {
-        webrtcManagerRef.current.sendMessageToHost(webrtcMessage)
+        guestManagerRef.current?.sendAction('PREV_PHASE', webrtcMessage.data)
       }
     }
@@ -4143,7 +4169,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests(webrtcMessage)
+        getCurrentManager()?.broadcastToGuests(webrtcMessage)
       } else {
-        webrtcManagerRef.current.sendMessageToHost(webrtcMessage)
+        guestManagerRef.current?.sendAction('SET_PHASE', webrtcMessage.data)
       }
     }
@@ -4189,7 +4215,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests(webrtcMessage)
+        getCurrentManager()?.broadcastToGuests(webrtcMessage)
       } else {
-        webrtcManagerRef.current.sendMessageToHost(webrtcMessage)
+        guestManagerRef.current?.sendAction('TOGGLE_AUTO_DRAW', webrtcMessage.data)
       }
     }
@@ -4247,7 +4273,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests(webrtcMessage)
+        getCurrentManager()?.broadcastToGuests(webrtcMessage)
       } else {
-        webrtcManagerRef.current.sendMessageToHost(webrtcMessage)
+        guestManagerRef.current?.sendAction('TOGGLE_ACTIVE_PLAYER', webrtcMessage.data)
       }
     }
@@ -4308,7 +4334,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'START_NEXT_ROUND',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { delta },
@@ -4326,7 +4352,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'START_NEW_MATCH',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { resetData },
@@ -4426,7 +4452,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'UPDATE_PLAYER_NAME',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { playerId, name },
@@ -4492,7 +4518,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'CHANGE_PLAYER_COLOR',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { playerId, color },
@@ -4540,7 +4566,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'UPDATE_PLAYER_SCORE',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { playerId, delta },
@@ -4669,7 +4695,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'UPDATE_PLAYER_NAME',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { playerId, name },
@@ -4697,7 +4723,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'CHANGE_PLAYER_COLOR',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { playerId, color },
@@ -4715,7 +4741,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'UPDATE_PLAYER_SCORE',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { playerId, delta },
@@ -4733,7 +4759,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'LOAD_CUSTOM_DECK',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { playerId, customDeck },
@@ -4941,7 +4967,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'START_READY_CHECK',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { delta },
@@ -5033,7 +5059,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'ASSIGN_TEAMS',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { teams },
@@ -5068,7 +5094,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'SET_GAME_MODE',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { gameMode },
@@ -5093,7 +5119,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'SET_GAME_PRIVACY',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { isPrivate },
@@ -5120,7 +5146,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'SET_GRID_SIZE',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { activeGridSize },
@@ -5143,7 +5169,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'SET_DUMMY_PLAYER_COUNT',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { dummyPlayerCount },
@@ -5175,7 +5201,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'LOG_GAME_ACTION',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { logEntry },
@@ -5261,7 +5287,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'START_READY_CHECK',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { delta },
@@ -5349,7 +5375,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'GAME_RESET',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { resetData },
@@ -5527,7 +5553,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
       case 'TRIGGER_HIGHLIGHT':
       case 'TRIGGER_NO_TARGET':
       case 'TRIGGER_FLOATING_TEXT':
-        webrtcManagerRef.current.broadcastToGuests(webrtcMessage)
+        getCurrentManager()?.broadcastToGuests(webrtcMessage)
         break
       case 'SYNC_HIGHLIGHTS':
         // Broadcast highlights to all guests
-        webrtcManagerRef.current.broadcastToGuests(webrtcMessage)
+        getCurrentManager()?.broadcastToGuests(webrtcMessage)
         break
       case 'SET_TARGETING_MODE':
       case 'CLEAR_TARGETING_MODE':
-        webrtcManagerRef.current.broadcastToGuests(webrtcMessage)
+        getCurrentManager()?.broadcastToGuests(webrtcMessage)
         break
       default:
         // For all other messages, guests send to host
         if (!webrtcIsHostRef.current) {
-          webrtcManagerRef.current.sendMessageToHost(webrtcMessage)
+          guestManagerRef.current?.sendAction(message.type, message.data)
         }
         break
     }
@@ -5567,7 +5593,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'REVEAL_REQUEST',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { fromPlayer, toPlayer, cardCount },
@@ -5584,7 +5610,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'REVEAL_RESPONSE',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { fromPlayer, cards },
@@ -5608,7 +5634,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'UPDATE_PLAYER_NAME',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { playerId, name },
@@ -5632,7 +5658,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'CHANGE_PLAYER_COLOR',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { playerId, color },
@@ -5656,7 +5682,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'UPDATE_PLAYER_SCORE',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { playerId, delta },
@@ -5680,7 +5706,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'UPDATE_PLAYER_NAME',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { playerId, name },
@@ -5704,7 +5730,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'CHANGE_PLAYER_COLOR',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { playerId, color },
@@ -5728,7 +5754,7 @@ export const useGameState = (props: UseGameStateProps = {}) => {
     // Check if we're in WebRTC mode
     if (webrtcEnabled && webrtcManagerRef.current) {
       if (webrtcIsHostRef.current) {
-        webrtcManagerRef.current.broadcastToGuests({
+          getCurrentManager()?.broadcastToGuests({
           type: 'UPDATE_PLAYER_SCORE',
           senderId: webrtcManagerRef.current.getPeerId(),
           data: { playerId, delta },
